
https://zhuanlan.zhihu.com/p/29604517

# 支持向量机（SVM，Support Vector Machine）

先从最简单的问题说起：一条直线上，有两个点，分别代表正类（好人）和负类（坏人），如图 1 所示，如何分界？

<img src="./images/1.png" />

<center>图 1.1.1 一条穿过两点的直线</center>

小学生都可以快速地回答：当然是取一个**中点**作为分割点，把好人坏人分开。

进一步，在两侧各增加了几个样本点，如何分界？如图 2 所示。

<img src="./images/2.png" />

<center>图 2.1.1 一条穿过两点的直线</center>

小学生稍微犹豫了一下，但还会做出正确的回答：仍然是在原来的分割点的位置上做分界，而不会由于好人坏人的数量或密度不一样而改变分割点位置。

好了，现在我们已经得到了支持向量机的最原始的概念了：在正类和负类样本之间，找到一个中点做分割点，让所有的正类样本点都在分割点右侧，所有的负类样本点都在分割点的左侧。附加条件是 $d_1$（分割点与最近的负类样本点的距离）和 $d_2$（分割点与最近的正类样本点的距离）相等。其中，距离分割点最近的样本点叫做**支持点**。

用数学语言描述，分割点命名为 $p$，正负类样本点用 $x_i$ 表示，而 $y_i$ 是标签值，$+1$ 代表正类，$-1$ 代表负类。

$$
\begin{cases}
x_i < p, \quad y_i=-1（即负类样本）
\\\\
x_i > p, \quad  y_i=+1（即正类样本）
\\\\
d_1 = d_2
\end{cases}
$$


下面我们把情况从以为扩展到二维。假设在二维空间中有两个样本点，分别属于正负类，如图 xx 所示。


<img src="./images/3.png" />

<center>图 2.1.1 一条穿过两点的直线</center>

- 左图

    分界线 $x_2 = a_1 x_1 + b_1$ 正确，符合两个条件：1）分界线垂直于两个样本点之间的连线；2）两个样本点距离分界线的距离一致，即 $d_1 = d_2$。

- 中图
  
    分界线 $x_2 = a_2 x_1 + b_2$ 向上偏移了，与左图比较的话，即 $a_2 = a_1，b_2 > b_1$，结果造成了 $d_1 > d_2$。

- 右图

   分界线 $x_2 = a_3 x_1 + b_3$ 倾斜了。与左图比较的话，即 $a_3 > a_1，b_3 < b_1$，虽然 $d_1 = d_2$，而且其到分界线的垂直距离 $d_3 = d_4$，但是分界线没有与两个样本的连线垂直，即 $d_3 < d_1，d_4<d_2$。

三个图中，虽然分界线都可以正确地分割了两个样本点，但只有左图是正确的，可以最大限度地容忍更多的样本点加入而无需重新分类，或者说在用这个分类模型做预测时的鲁棒性最强，误差最小。

从这几个例子可以看出来，分类与回归不同：
- 在回归中，尽量让均方差最小，得到的效果是每个样本都想把回归线尽量拉向自己，最终的回归结果是**所有样本点**的“引力”的均衡；
- 而在分类中，尽量让分界距离最大，得到的效果是每一类样本都想把分界线推向对方，最终的分类结果是两类样本中**关键点**的“推力”的均衡。


用数学语言描述

如果分界线是：

$$
x_2 = ax_1+b
$$

则：

$$
\begin{cases}
x_{i2} < a x_{i1} + b, \quad y_i=-1（即负类样本）
\\\\
x_{i2} > a x_{i1} + b, \quad  y_i=+1（即正类样本）
\\\\
d_1 = d_2
\end{cases}
$$

用几何概念来解释，就是负类在分界线的下方，正类在分界线的上方。当然，这里的正类负类是人为指定的，也可以约定相反的符号，这样正类就会在分界线的下方，这会造成理解上的障碍，但是并不妨碍最后的推导结果正确。

### 分类间隔

在图 x 中的左子图中，$d_1、d_2$ 具有的几何意义很明确，但是需要用数学公式来表达，那就是点到直线的距离。

$$
d_0 = \frac{|Ax_0+By_0+c|}{\sqrt{A^2+B^2}}
$$

<img src="./images/4.png" />

<center>图 2.1.1 一条穿过两点的直线</center>

由于 $d$ 的存在，我们在分界线的两侧各画一条与分界线平行的直线，并穿过样本点，形成一个带状的间隔，这样就能扩展 $d$ 的作用：即距离 $d$ 存在于整条分界线的两侧，而不是仅仅限于两个样本点之间。


### 增加新的样本点

<img src="./images/5.png" />

<center>图 2.1.1 一条穿过两点的直线</center>

- 左图
- 中图
  
    在中图中，正类上（三角形）增加的样本点，由于在分类间隔之外，所以并没有影响已有的分界线（既分类间隔）的正确性。

- 右图

    在负类上（实心圆点）增加的样本已经在间隔以内了，所以必须重新计算分界线。



在右图中，就是重新计算的分界线及分类间隔的结果，可以想象成是中图中的分类间隔。可以看到，负类中有两个点在分类间隔上，这并不是巧合，而是分类间隔在这个角度上，可以刚刚好分类正确，并且得到的 $d$ 值 最大。

图中的 $d_2 < d_1$，但这已经是分来间隔可以做到的最优解了，再逆时针旋转的话，会造成 $d_2$ 值进一步减小。