
## 1.2 几个基本的数学概念

为了继续学习后面的知识，我们先回顾一下以下几个基本的数学概念。下面的描述都是基于离散数据的，连续型数据（需要积分运算）不在此范围内。

### 均值（Mean）

一个离散序列的算术平均数：

$$
\bar{\boldsymbol{x}} = \frac{1}{n}\sum\limits_{i=1}^n x_i \tag{1.2.1}
$$

比如一个数组（向量）$x=[1,2,3,4,5,6]$，其均值为 $(1+2+3+4+5+6)/6=3.5$。

### 数学期望（Mathematical Expectation）

对于离散的随机变量，其一切的可能的取值 $x_i$ 与对应的可能出现的概率 $p_i$ 的乘积之和就是该离散序列的数学期望。

$$
E[\boldsymbol{x}] = \sum_{i=1}^n p_i x_i \tag{1.2.2}
$$

比如一个六面的骰子（1 到 6），掷出每个数字的概率都是 $\frac{1}{6}$，即 $p_i=\frac{1}{6}$，则：

$$
E[x] = \frac{1}{6}\times 1+\frac{1}{6}\times 2+\frac{1}{6}\times 3+\frac{1}{6}\times 4+\frac{1}{6}\times 5+\frac{1}{6}\times 6=3.5
$$

如果是做了手脚的骰子，掷出 1 至 6 的概率分别为 $p=[0.1,0.1,0.1,0.3,0.4,0.0]$，则 $E[x]=0.1 \times 1+0.1 \times 2+0.1 \times 3+0.3 \times 4+0.4 \times 5+0.0 \times 6=3.8$。

如果所有变量出现的概率 $p_i$ 相等的话，则数学期望就等于均值。

### 方差（Variance）

方差（variance）这一词语率先由英国统计学家罗纳德·费雪（Ronald Fisher，1890-1962）提出。

统计学中的方差（样本方差）是每个样本值与全体样本值的平均数之差的平方值的平均数，它描述了随机变量与均值的偏离程度，其数值越大，说明数据离散程度越高。

当变量总体数量已知为 $n$ 时，总体方差为：

$$
\begin{aligned}
\sigma^2 &=\frac{1}{n} \sum_{i=1}^n(x_i-\bar x)^2 \\
&=\frac{1}{n} \sum_{i=1}^n x_i^2 - (\frac{1}{n} \sum_{i=1}^n x_i)^2
\end{aligned}
\tag{1.2.3}    
$$

公式推导详见 1.5 小节。

当总体数量未知时，用抽取的样本数量 $m (m < n)$ 代替，经校正后，样本方差为：

$$
S^2=\frac{1}{m-1}\sum_{i=1}^n (x_i-\bar x)^2 \tag{1.2.4}
$$

在概率论分布中，随机离散变量的方差公式是：

$$
\begin{aligned}
var(x) &= E[(x-E[x])^2]
\\
&=E[x^2]-E^2[x] 
\end{aligned}
\tag{1.2.5}
$$

公式推导详见 1.5 小节。

比如两个数据集合：A=[0,8,12,20]，B=[8,9,11,12]，其均值都是 10，但是二者的方差是：

$$
S^2(A) = [(0-10)^2+(8-10)^2+(12-10)^2+(20-10)^2]/3=69.33
\\
S^2(B) = [(8-10)^2+(9-10)^2+(11-10)^2+(12-10)^2]/3=3.33
$$

可以看到 A 的方差比 B 大很多，离散程度较高。

### 标准差（Standard Deviation）

标准差是方差的平方根。

根据公式1.2.3，有：

$$
\sigma = \sqrt{\frac{1}{n} \sum_{i=1}^n(x_i-\bar x)^2}
\tag{1.2.6}    
$$

或：

$$
S = \sqrt{\frac{1}{n-1} \sum_{i=1}^n(x_i-\bar x)^2}
\tag{1.2.7}    
$$

还使用上面的例子计算 A 和 B 的标准差S：
$$
S(A) = 8.3，S(B) = 1.8
$$

既然有了方差来描述变量与均值的偏离程度，那标准差有什么用呢？

方差与我们要处理的数据的量纲是不一致的，虽然能很好的描述数据与均值的偏离程度，但是处理结果是不符合我们的直观思维的。比如想比较不同机房的服务器数量的分布，方差计算出来的数值是“台数”的平方，而标准差就是“台数”。

### 协方差（Covariance）

在概率论和统计学中，协方差用于衡量两个变量的总体误差。而方差是协方差的一种特殊情况，即当两个变量是相同的情况。

期望值分别为 $E[x]$ 与 $E[y]$ 的两个实随机变量 $x$ 与 $y$ 之间的协方差 $cov(x,y)$ 定义为：

$$
\begin{aligned}
cov(x,y) &= E[(x-E(x))(y-E[y])]
\\
&=E[xy]-E[x]E[y]
\end{aligned}
\tag{1.2.8}
$$

公式推导详见 1.5 小节。

比较公式 1.2.5 和 1.2.6，把后者中的 $x$ 换成 $y$，就变成了前者，可见方差是协方差的特殊形式。

对于离散变量，公式如下：

$$
\begin{aligned}
cov(x,y) &= \frac{1}{n} \sum_{i=1}^n (x_i -\bar x)(y_i - \bar y)    \\
&= \frac{1}{n}\sum_{i=1}^nx_iy_i - \frac{1}{n^2}\sum_{i=1}^nx_i \sum_{i=1}^ny_i
\end{aligned}

\tag{1.2.9}
$$

公式推导详见 1.5 小节。

样本协方差公式：

$$
cov(x,y) = \frac{1}{n-1} \sum_{i=1}^n (x_i -\bar x)(y_i - \bar y)    
\tag{1.2.10}
$$

### 均方（误）差（MSE，Mean Squared Error）

如图 1.2.2所示，假设三个样本（红色圆点，$p_1(2,2)、p_2(2,3)、p_3(4,3)$）的标签值为 $y=[2,3,3]$，我们训练了两个回归模型，分别是：

$$
\begin{aligned}
(a) \quad y &= x
\\
(b) \quad y &= 0.6x+1
\end{aligned}
\tag{1.2.11}
$$

当 $x=[2,3,4]$时，从（a）得到的预测结果是 $\hat{y}_a=[2,3,4]$，从（b）得到的预测结果是 $\hat{y}_b=[2.2,2.8,3.4]$，两条直线哪一个回归结果较好呢？

<img src="./images/1-2-1.png" />
<center>图 1.2.1 回归直线的误差</center>

均方差就是描述标签值 $y$ 和预测结果 $\hat{y}$ 之间的差距的，通常用于做误差函数（或者叫做代价函数），机器学习的目的就是让尽量误差函数值达到最小。

$$
MSE = \frac{1}{n} \sum_{i=1}^n (y_i - \hat{y_i})^2 \tag{1.2.12}
$$

用上面的例子，对于预测结果（a），均方差为：

$$
MSE(a)=[(2-2)^2+(3-3)^2+(3-4)^2]/3=0.33
$$

对于预测结果（b），均方差为：

$$
MSE(b)=[(2-2.2)^2+(3-2.8)^2+(3-3.4)^2]/3=0.08
$$

可以看到，虽然结果（a）可以准确地拟合 $p_1$ 和 $p_3$，但是在 $p_2$ 上的误差太大了；结果（b）虽然在三个点 $p_1、p_2、p_3$ 上都有误差，但是都比较小，总体的误差也会比（a）好。

当样本较多的时候，误差项多，均方差的数值也会比较大，所以无法用一个数值来衡量均方差是否达到要求了，只能自己和自己比。


### 偏差

假设图 1.2.1 中椭圆内的黑色样本圆点是针对一个机器学习问题中的所有可能的数据集 D，三个圆形区域内的样本是子数据集 Da、Db、Dc。

<img src="./images/1-2-2.png" />
<center>图 1.2.2 样本数据可视化</center>

如果我们能获得所有可能的数据集（这一般是做不到的，我们只能收集尽量多的数据样本），则可以训练出一个真实模型 Mr。用子数据集 Da 训练出来的模型 Ma，它的预测输出不可能超出左侧的圆形范围，那么这就会与真实模型造成偏差。同样，Mb 和 Mc 也会有偏差。这种偏差，直接和真是模型的输出做对比就可以知道了。

但是！请不要忘记，一般情况下我们不知道全部数据 D 和真实模型 Mr，所以只能用模型 Ma、Mb、Mc 来近似模拟。

假设某个样本 $x$ 的真实值为 $y$，模型 Ma、Mb、Mc 对样本 $x$ 的预测输出分别为 $y_a、y_b、y_c$，则期望预测为：

$$
\hat{y} = E[(y_a,y_b,y_c)]
$$

可以简单理解为 $\hat{y}$ 是 $y_a、y_b、y_c$ 的算数或几何平均，见图 1.2.1 右侧子图。那么偏差 bias 的定义是：

$$
bias^2(x) = (\hat{y}-y)^2 \tag{1.2.11}
$$